{% extends 'base.html' %}

{% block title %}Browse Questions & Answers{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto" x-data="questionsPage()">
    <div class="bg-white p-8 rounded-xl shadow-md">
        <h2 class="text-3xl font-bold mb-6 text-green-800">Questions & Answers</h2>
        
        <div class="space-y-6">
            <template x-for="question in questions" :key="question.id">
                <div class="border-b pb-6">
                    <div class="flex items-start mb-3">
                        <div class="bg-green-100 rounded-full p-3 mr-4">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm text-gray-500 mb-1">Asked by <span class="font-medium" x-text="question.farmer_name"></span></p>
                            <p class="text-lg text-gray-800" x-text="question.content"></p>
                            <span class="inline-block mt-2 text-xs px-2 py-1 rounded-full" 
                                  :class="question.is_answered ? 'bg-green-100 text-green-800' : 'bg-orange-100 text-orange-800'"
                                  x-text="question.is_answered ? 'Answered' : 'Pending'"></span>
                        </div>
                    </div>
                    
                    <!-- Answers -->
                    <div x-show="question.answers && question.answers.length > 0" class="ml-14 mt-4 space-y-3">
                        <template x-for="answer in question.answers" :key="answer.id">
                            <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                                <p class="text-sm text-blue-900 font-medium mb-2">Expert: <span x-text="answer.expert_name"></span></p>
                                <p class="text-gray-700" x-text="answer.content"></p>
                                <p class="text-xs text-gray-500 mt-2" x-text="new Date(answer.created_at).toLocaleString()"></p>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>

<script>
function questionsPage() {
    return {
        questions: [],
        
        init() {
            this.fetchQuestions();
        },
        
        async fetchQuestions() {
            try {
                const response = await fetch('/api/experts/questions/');
                if (response.ok) {
                    this.questions = await response.json();
                }
            } catch (error) {
                console.error('Error fetching questions:', error);
            }
        }
    }
}
</script>
{% endblock %}
